<script lang="ts">
  let { filename = '', sizeClass = 'w-10 h-10' } = $props<{ filename?: string; sizeClass?: string; }>();

  const FILE_ICON_META = {
    pdf: { svg: `<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 115.28 122.88"><path d="M25.38 57h64.88V37.34H69.59c-2.17 0-5.19-1.17-6.62-2.6-1.43-1.43-2.3-4.01-2.3-6.17V7.64H8.15c-.18 0-.32.09-.41.18-.15.1-.19.23-.19.42v106.45c0 .14.09.32.18.41.09.14.28.18.41.18h81.51c.18 0 .17-.09.27-.18.14-.09.33-.28.33-.41v-11.16H25.38c-4.14 0-7.56-3.4-7.56-7.56V64.55c0-4.15 3.4-7.55 7.56-7.55zm4.12 10.4h13.19c2.87 0 5.02.68 6.46 2.05 1.43 1.37 2.14 3.31 2.14 5.84 0 2.59-.78 4.62-2.34 6.08-1.56 1.46-3.94 2.19-7.14 2.19h-4.35v9.49H29.5V67.4zm7.95 10.97h1.95c1.54 0 2.62-.27 3.24-.8.62-.53.93-1.21.93-2.04 0-.81-.27-1.49-.81-2.05-.54-.56-1.55-.84-3.05-.84h-2.27v5.73h.01zM54.99 67.4h11.78c2.32 0 4.2.32 5.63.94 1.43.63 2.61 1.53 3.55 2.71.93 1.18 1.61 2.55 2.02 4.11.42 1.56.63 3.22.63 4.97 0 2.74-.31 4.87-.94 6.38-.62 1.51-1.49 2.78-2.6 3.8s-2.3 1.7-3.57 2.04c-1.74.47-3.31.7-4.72.7H54.99V67.4zm7.91 5.81v14.01h1.95c1.66 0 2.84-.19 3.55-.55.7-.37 1.25-1.01 1.65-1.92.4-.92.6-2.4.6-4.45 0-2.72-.44-4.57-1.33-5.58-.89-1-2.36-1.5-4.42-1.5h-2v-.01zm19.35-5.81h19.6v5.52H90.21v4.48h9.96v5.2h-9.96v10.46h-7.95V67.4h-.01zM97.79 57h9.93c4.16 0 7.56 3.41 7.56 7.56v31.42c0 4.15-3.41 7.56-7.56 7.56h-9.93v13.55c0 1.61-.65 3.04-1.7 4.1a5.74 5.74 0 0 1-4.1 1.7H5.81a5.74 5.74 0 0 1-4.1-1.7 5.74 5.74 0 0 1-1.7-4.1V5.85c0-1.61.65-3.04 1.7-4.1a5.81 5.81 0 0 1 4.1-1.7h58.72c.13-.05.27-.05.41-.05.64 0 1.29.28 1.75.69h.09c.09.05.14.09.23.18L97 31.23c.51.51.88 1.2.88 1.98 0 .23-.05.41-.09.65V57zM67.52 27.97V8.94l21.43 21.7H70.19c-.74 0-1.38-.32-1.89-.78-.46-.46-.78-1.15-.78-1.89z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>`,
      label: 'PDF document' },
    doc: { svg: `<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 115.28 122.88"><path d="M25.38 57h64.88V37.34H69.59c-2.17 0-5.19-1.17-6.62-2.6-1.43-1.43-2.3-4.01-2.3-6.17V7.64H8.15c-.18 0-.32.09-.41.18-.15.1-.19.23-.19.42v106.45c0 .14.09.32.18.41.09.14.28.18.41.18h81.51c.18 0 .17-.09.27-.18.14-.09.33-.28.33-.41v-11.16H25.38c-4.14 0-7.56-3.4-7.56-7.56V64.55c0-4.15 3.4-7.55 7.56-7.55zm4.13 11.52h10.81c2.12 0 3.85.29 5.16.87 1.31.58 2.39 1.41 3.25 2.49.85 1.08 1.47 2.34 1.86 3.77.39 1.43.58 2.95.58 4.56 0 2.51-.28 4.46-.86 5.85-.57 1.39-1.36 2.55-2.38 3.48-1.02.94-2.11 1.56-3.27 1.87-1.59.43-3.04.64-4.33.64H29.51V68.52zm7.26 5.33V86.7h1.79c1.52 0 2.61-.17 3.25-.5.64-.34 1.14-.93 1.51-1.76.37-.84.55-2.2.55-4.09 0-2.49-.41-4.19-1.22-5.12-.82-.92-2.17-1.38-4.06-1.38h-1.82zm16.24 6.45c0-3.84 1.07-6.83 3.21-8.97 2.14-2.14 5.12-3.21 8.94-3.21 3.92 0 6.93 1.05 9.05 3.15 2.12 2.1 3.18 5.05 3.18 8.83 0 2.75-.46 5-1.39 6.76a9.985 9.985 0 0 1-4.01 4.11c-1.75.98-3.93 1.47-6.54 1.47-2.65 0-4.85-.42-6.59-1.27-1.74-.85-3.15-2.19-4.23-4.01-1.08-1.82-1.62-4.11-1.62-6.86zm7.26.02c0 2.37.44 4.08 1.33 5.12.89 1.04 2.09 1.56 3.61 1.56 1.56 0 2.78-.51 3.63-1.52.86-1.02 1.29-2.84 1.29-5.47 0-2.21-.45-3.83-1.34-4.85-.9-1.02-2.11-1.53-3.64-1.53-1.47 0-2.65.52-3.54 1.56-.89 1.02-1.34 2.74-1.34 5.13zm35.67 2.1 6.38 1.92c-.43 1.79-1.1 3.28-2.03 4.47-.92 1.2-2.06 2.1-3.43 2.71-1.36.61-3.1.91-5.21.91-2.56 0-4.65-.37-6.28-1.11-1.62-.74-3.02-2.05-4.2-3.92-1.18-1.87-1.77-4.27-1.77-7.18 0-3.89 1.04-6.88 3.11-8.97 2.08-2.09 5.01-3.13 8.8-3.13 2.96 0 5.3.6 6.99 1.8 1.69 1.2 2.96 3.04 3.78 5.53l-6.41 1.42c-.22-.71-.46-1.23-.71-1.56-.41-.55-.91-.98-1.49-1.28-.59-.3-1.25-.45-1.98-.45-1.65 0-2.92.66-3.8 1.98-.66.98-1 2.52-1 4.62 0 2.61.39 4.39 1.19 5.36.79.96 1.91 1.45 3.34 1.45 1.39 0 2.44-.39 3.15-1.17.74-.78 1.25-1.91 1.57-3.4zM97.79 57h9.93c4.16 0 7.56 3.41 7.56 7.56v31.42c0 4.15-3.41 7.56-7.56 7.56h-9.93v13.55c0 1.61-.65 3.04-1.7 4.1a5.74 5.74 0 0 1-4.1 1.7H5.81a5.74 5.74 0 0 1-4.1-1.7 5.74 5.74 0 0 1-1.7-4.1V5.85c0-1.61.65-3.04 1.7-4.1a5.81 5.81 0 0 1 4.1-1.7h58.72c.13-.05.27-.05.41-.05.64 0 1.29.28 1.75.69h.09c.09.05.14.09.23.18L97 31.23c.51.51.88 1.2.88 1.98 0 .23-.05.41-.09.65V57zM67.52 27.97V8.94l21.43 21.7H70.19c-.74 0-1.38-.32-1.89-.78-.46-.46-.78-1.15-.78-1.89z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>`,
      label: 'Word 97-2003 document' },
    docx: { svg: `<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 115.28 122.88"><path d="M21.93 57h68.32V37.34H69.59c-2.17 0-5.19-1.17-6.62-2.6-1.43-1.43-2.3-4.01-2.3-6.17V7.64H8.15c-.18 0-.32.09-.41.18-.15.1-.19.23-.19.42v106.45c0 .14.09.32.18.41.09.14.28.18.41.18h81.51c.18 0 .17-.09.27-.18.14-.09.33-.28.33-.41v-11.16H21.93c-4.14 0-7.56-3.4-7.56-7.56V64.55c.01-4.15 3.41-7.55 7.56-7.55zm4.04 12.89h8.9c1.75 0 3.17.24 4.25.71 1.08.48 1.97 1.16 2.68 2.05.7.89 1.21 1.93 1.53 3.11.32 1.18.48 2.43.48 3.75 0 2.07-.23 3.67-.71 4.82-.47 1.14-1.12 2.1-1.96 2.87-.84.77-1.74 1.28-2.7 1.54-1.31.35-2.5.53-3.57.53h-8.9V69.89zm5.97 4.38v10.58h1.47c1.25 0 2.15-.14 2.68-.42.53-.28.94-.76 1.24-1.45.3-.69.45-1.81.45-3.36 0-2.05-.33-3.45-1.01-4.21-.67-.76-1.79-1.14-3.34-1.14h-1.49zm12.93 5.32c0-3.16.88-5.62 2.64-7.38 1.76-1.76 4.22-2.64 7.36-2.64 3.22 0 5.71.87 7.45 2.59 1.75 1.73 2.62 4.16 2.62 7.27 0 2.26-.38 4.12-1.14 5.56-.76 1.45-1.87 2.57-3.3 3.38-1.44.81-3.24 1.21-5.39 1.21-2.18 0-3.99-.35-5.42-1.04-1.43-.7-2.59-1.8-3.48-3.3-.9-1.5-1.34-3.39-1.34-5.65zm5.97.01c0 1.95.37 3.36 1.09 4.21.73.85 1.72 1.28 2.98 1.28 1.28 0 2.29-.42 2.99-1.25.71-.84 1.06-2.34 1.06-4.5 0-1.82-.37-3.15-1.1-3.99-.74-.84-1.74-1.26-3-1.26-1.21 0-2.18.43-2.91 1.28-.74.85-1.11 2.26-1.11 4.23zm28.92 1.73 5.25 1.58c-.35 1.47-.91 2.7-1.67 3.68-.76.99-1.7 1.73-2.82 2.23-1.12.5-2.55.75-4.29.75-2.11 0-3.83-.31-5.17-.92-1.33-.61-2.48-1.69-3.45-3.23-.97-1.54-1.46-3.51-1.46-5.91 0-3.2.85-5.66 2.56-7.39 1.71-1.72 4.12-2.58 7.24-2.58 2.44 0 4.36.49 5.76 1.48 1.39.99 2.43 2.5 3.11 4.55l-5.28 1.17c-.18-.59-.38-1.01-.58-1.28-.34-.46-.75-.81-1.23-1.05-.49-.25-1.03-.37-1.63-.37-1.36 0-2.4.55-3.12 1.63-.55.81-.82 2.08-.82 3.81 0 2.15.32 3.61.98 4.41.65.79 1.57 1.19 2.75 1.19 1.15 0 2.01-.32 2.6-.96.58-.63 1-1.56 1.27-2.79zm5.51-11.44h6.6l3.43 5.96 3.33-5.96h6.52l-6.02 9.38 6.59 9.99h-6.74l-3.8-6.22-3.83 6.22h-6.68l6.68-10.1-6.08-9.27zM97.79 57h9.93c4.16 0 7.56 3.41 7.56 7.56v31.42c0 4.15-3.41 7.56-7.56 7.56h-9.93v13.55c0 1.61-.65 3.04-1.7 4.1a5.74 5.74 0 0 1-4.1 1.7H5.81a5.74 5.74 0 0 1-4.1-1.7 5.74 5.74 0 0 1-1.7-4.1V5.85c0-1.61.65-3.04 1.7-4.1a5.81 5.81 0 0 1 4.1-1.7h58.72c.13-.05.27-.05.41-.05.64 0 1.29.28 1.75.69h.09c.09.05.14.09.23.18L97 31.23c.51.51.88 1.2.88 1.98 0 .23-.05.41-.09.65V57zM67.52 27.97V8.94l21.43 21.7H70.19c-.74 0-1.38-.32-1.89-.78-.46-.46-.78-1.15-.78-1.89z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>`,
      label: 'Word document' },
    txt: { svg: `<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 115.28 122.88"><path d="M25.38 57h64.88V37.34H69.59c-2.17 0-5.19-1.17-6.62-2.6-1.43-1.43-2.3-4.01-2.3-6.17V7.64H8.15c-.18 0-.32.09-.41.18-.15.1-.19.23-.19.42v106.45c0 .14.09.32.18.41.09.14.28.18.41.18h81.51c.18 0 .17-.09.27-.18.14-.09.33-.28.33-.41v-11.16H25.38c-4.14 0-7.56-3.4-7.56-7.56V64.55c0-4.15 3.4-7.55 7.56-7.55zm4.18 11.12H51.9V74h-7.5v17.9h-7.34V74h-7.5v-5.88zm24.07 0h8.1l4.21 7.32 4.09-7.32h8l-7.39 11.52 8.08 12.26h-8.27l-4.66-7.64-4.7 7.64h-8.2l8.2-12.39-7.46-11.39zm25.86 0h22.34V74h-7.5v17.9h-7.34V74h-7.5v-5.88zM97.79 57h9.93c4.16 0 7.56 3.41 7.56 7.56v31.42c0 4.15-3.41 7.56-7.56 7.56h-9.93v13.55c0 1.61-.65 3.04-1.7 4.1a5.74 5.74 0 0 1-4.1 1.7H5.81a5.74 5.74 0 0 1-4.1-1.7 5.74 5.74 0 0 1-1.7-4.1V5.85c0-1.61.65-3.04 1.7-4.1a5.81 5.81 0 0 1 4.1-1.7h58.72c.13-.05.27-.05.41-.05.64 0 1.29.28 1.75.69h.09c.09.05.14.09.23.18L97 31.23c.51.51.88 1.2.88 1.98 0 .23-.05.41-.09.65V57zM67.52 27.97V8.94l21.43 21.7H70.19c-.74 0-1.38-.32-1.89-.78-.46-.46-.78-1.15-.78-1.89z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>`,
      label: 'Text file' },
    unsupported: { svg: `<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 115.28 122.88"><path d="M21.93 57h68.32V37.34H69.59c-2.17 0-5.19-1.17-6.62-2.6-1.43-1.43-2.3-4.01-2.3-6.17V7.64H8.15c-.18 0-.32.09-.41.18-.15.1-.19.23-.19.42v106.45c0 .14.09.32.18.41.09.14.28.18.41.18h81.51c.18 0 .17-.09.27-.18.14-.09.33-.28.33-.41v-11.16H21.93c-4.14 0-7.56-3.4-7.56-7.56V64.55c.01-4.15 3.41-7.55 7.56-7.55zm4.04 12.89h8.9c1.75 0 3.17.24 4.25.71 1.08.48 1.97 1.16 2.68 2.05.7.89 1.21 1.93 1.53 3.11.32 1.18.48 2.43.48 3.75 0 2.07-.23 3.67-.71 4.82-.47 1.14-1.12 2.1-1.96 2.87-.84.77-1.74 1.28-2.7 1.54-1.31.35-2.5.53-3.57.53h-8.9V69.89zm5.97 4.38v10.58h1.47c1.25 0 2.15-.14 2.68-.42.53-.28.94-.76 1.24-1.45.3-.69.45-1.81.45-3.36 0-2.05-.33-3.45-1.01-4.21-.67-.76-1.79-1.14-3.34-1.14h-1.49zm12.93 5.32c0-3.16.88-5.62 2.64-7.38 1.76-1.76 4.22-2.64 7.36-2.64 3.22 0 5.71.87 7.45 2.59 1.75 1.73 2.62 4.16 2.62 7.27 0 2.26-.38 4.12-1.14 5.56-.76 1.45-1.87 2.57-3.3 3.38-1.44.81-3.24 1.21-5.39 1.21-2.18 0-3.99-.35-5.42-1.04-1.43-.7-2.59-1.8-3.48-3.3-.9-1.5-1.34-3.39-1.34-5.65zm5.97.01c0 1.95.37 3.36 1.09 4.21.73.85 1.72 1.28 2.98 1.28 1.28 0 2.29-.42 2.99-1.25.71-.84 1.06-2.34 1.06-4.5 0-1.82-.37-3.15-1.1-3.99-.74-.84-1.74-1.26-3-1.26-1.21 0-2.18.43-2.91 1.28-.74.85-1.11 2.26-1.11 4.23zm28.92 1.73 5.25 1.58c-.35 1.47-.91 2.7-1.67 3.68-.76.99-1.7 1.73-2.82 2.23-1.12.5-2.55.75-4.29.75-2.11 0-3.83-.31-5.17-.92-1.33-.61-2.48-1.69-3.45-3.23-.97-1.54-1.46-3.51-1.46-5.91 0-3.2.85-5.66 2.56-7.39 1.71-1.72 4.12-2.58 7.24-2.58 2.44 0 4.36.49 5.76 1.48 1.39.99 2.43 2.5 3.11 4.55l-5.28 1.17c-.18-.59-.38-1.01-.58-1.28-.34-.46-.75-.81-1.23-1.05-.49-.25-1.03-.37-1.63-.37-1.36 0-2.4.55-3.12 1.63-.55.81-.82 2.08-.82 3.81 0 2.15.32 3.61.98 4.41.65.79 1.57 1.19 2.75 1.19 1.15 0 2.01-.32 2.6-.96.58-.63 1-1.56 1.27-2.79zm5.51-11.44h6.6l3.43 5.96 3.33-5.96h6.52l-6.02 9.38 6.59 9.99h-6.74l-3.8-6.22-3.83 6.22h-6.68l6.68-10.1-6.08-9.27zM97.79 57h9.93c4.16 0 7.56 3.41 7.56 7.56v31.42c0 4.15-3.41 7.56-7.56 7.56h-9.93v13.55c0 1.61-.65 3.04-1.7 4.1a5.74 5.74 0 0 1-4.1 1.7H5.81a5.74 5.74 0 0 1-4.1-1.7 5.74 5.74 0 0 1-1.7-4.1V5.85c0-1.61.65-3.04 1.7-4.1a5.81 5.81 0 0 1 4.1-1.7h58.72c.13-.05.27-.05.41-.05.64 0 1.29.28 1.75.69h.09c.09.05.14.09.23.18L97 31.23c.51.51.88 1.2.88 1.98 0 .23-.05.41-.09.65V57zM67.52 27.97V8.94l21.43 21.7H70.19c-.74 0-1.38-.32-1.89-.78-.46-.46-.78-1.15-.78-1.89z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>`,
      label: 'Unsupported file type' }
    //, ppt: { svg: `<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 115.28 122.88"><path d="M25.38 57h64.88V37.34H69.59c-2.17 0-5.19-1.17-6.62-2.6-1.43-1.43-2.3-4.01-2.3-6.17V7.64H8.15c-.18 0-.32.09-.41.18-.15.1-.19.23-.19.42v106.45c0 .14.09.32.18.41.09.14.28.18.41.18h81.51c.18 0 .17-.09.27-.18.14-.09.33-.28.33-.41v-11.16H25.38c-4.14 0-7.56-3.4-7.56-7.56V64.55c0-4.15 3.4-7.55 7.56-7.55zm4.14 10.41h13.1c2.85 0 4.99.68 6.41 2.03 1.42 1.36 2.13 3.29 2.13 5.8 0 2.57-.78 4.59-2.33 6.04-1.55 1.45-3.91 2.18-7.09 2.18h-4.32v9.43h-7.9V67.41zm7.9 10.89h1.94c1.53 0 2.6-.27 3.22-.79.62-.53.93-1.2.93-2.03 0-.8-.27-1.48-.81-2.03-.53-.56-1.54-.84-3.03-.84h-2.25v5.69zM54.7 67.41h13.1c2.85 0 4.99.68 6.41 2.03 1.42 1.36 2.13 3.29 2.13 5.8 0 2.57-.78 4.59-2.33 6.04-1.55 1.45-3.91 2.18-7.09 2.18H62.6v9.43h-7.9V67.41zm7.9 10.89h1.94c1.53 0 2.6-.27 3.22-.79.62-.53.93-1.2.93-2.03 0-.8-.27-1.48-.81-2.03-.53-.56-1.54-.84-3.03-.84H62.6v5.69zm15.53-10.89h23.95v6.3h-8.04v19.18h-7.87V73.71h-8.04v-6.3zM97.79 57h9.93c4.16 0 7.56 3.41 7.56 7.56v31.42c0 4.15-3.41 7.56-7.56 7.56h-9.93v13.55c0 1.61-.65 3.04-1.7 4.1a5.74 5.74 0 0 1-4.1 1.7H5.81a5.74 5.74 0 0 1-4.1-1.7 5.74 5.74 0 0 1-1.7-4.1V5.85c0-1.61.65-3.04 1.7-4.1a5.81 5.81 0 0 1 4.1-1.7h58.72c.13-.05.27-.05.41-.05.64 0 1.29.28 1.75.69h.09c.09.05.14.09.23.18L97 31.23c.51.51.88 1.2.88 1.98 0 .23-.05.41-.09.65V57zM67.52 27.97V8.94l21.43 21.7H70.19c-.74 0-1.38-.32-1.89-.78-.46-.46-.78-1.15-.78-1.89z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>`,
    //label: 'PowerPoint' }
  } satisfies Record<string, Readonly<{ svg: string; label: string }>>;

  type IconKey = keyof typeof FILE_ICON_META;

  function mapExtensionToIconKey(ext: string | undefined): IconKey {
    const e = (ext ?? '').toLowerCase();
    return Object.prototype.hasOwnProperty.call(FILE_ICON_META, e) ? (e as IconKey) : 'unsupported';
  }

  function getFileExtension(name: string): string {
    const i = name.lastIndexOf('.');
    return i > 0 ? name.slice(i + 1) : '';
  }

  const iconKey = $derived(mapExtensionToIconKey(getFileExtension(filename)));
  const meta = $derived(FILE_ICON_META[iconKey]);
</script>

<div class:file-icon-wrapper={true}
     class={sizeClass}
     aria-hidden="true"
     title={meta.label}>
  {@html meta.svg}
</div>

<style>
  .file-icon-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .file-icon-wrapper :global(svg) {
    width: 100%;
    height: 100%;
  }
</style>